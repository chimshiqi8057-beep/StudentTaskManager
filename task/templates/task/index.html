<!DOCTYPE html>
<html>
<head>
    <title>Student Task Manager</title>
    <style>
        body { font-family: sans-serif; margin: 40px; background-color: #fcfcfc; }
        .container { max-width: 900px; margin: auto; }
        .card { background: white; padding: 20px; border-radius: 8px; border: 1px solid #ddd; margin-bottom: 20px; box-shadow: 2px 2px 5px rgba(0,0,0,0.05); }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; }
        th, td { padding: 12px; border: 1px solid #ddd; text-align: left; }
        th { background: #4CAF50; color: white; }
        .btn-complete { background: #008CBA; color: white; padding: 5px 10px; text-decoration: none; border-radius: 4px; font-size: 13px; }
        .High { color: red; font-weight: bold; }
        .Medium { color: orange; }
        .Low { color: green; }
        .task-done { text-decoration: line-through; color: #888; background-color: #f9f9f9; }
    </style>
</head>
<body>
<div class="container">
    <h1>üìù Student Task Manager</h1>

    <div class="card">
        <h3>+ Add New Task</h3>
        <form method="POST">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" style="background: #4CAF50; color: white; border: none; padding: 10px 20px; cursor: pointer; border-radius: 4px;">Add Task</button>
        </form>
    </div>

    <div style="margin-bottom: 20px;">
        <form method="GET">
            <input type="text" name="q" placeholder="Search by subject..." value="{{ request.GET.q }}" style="padding: 8px; width: 250px;">
            <button type="submit" style="padding: 8px;">Search</button>
            <a href="/" style="margin-left: 10px; color: #666; text-decoration: none;">Reset</a>
        </form>
    </div>

    <table>
        <thead>
            <tr>
                <th>Subject</th>
                <th>Task Title</th>
                <th>Priority</th>
                <th>Deadline</th>
                <th>Status / Action</th>
            </tr>
        </thead>
        <tbody>
            {% for t in tasks %}
            <tr class="{% if t.is_completed %}task-done{% endif %}">
                <td>{{ t.subject }}</td>
                <td>{{ t.title }}</td>
                <td class="{{ t.priority }}">{{ t.priority }}</td>
                <td>{{ t.deadline|date:"Y-m-d H:i" }}</td>
                <td>
                    {% if t.is_completed %}
                        <span style="color: green; font-weight: bold;">‚úÖ Done</span>
                    {% else %}
                        <span style="color: gray;">‚è≥ Pending</span>
                        <a href="{% url 'complete_task' t.id %}" class="btn-complete">Complete</a>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" style="text-align: center;">No tasks found. Try adding one!</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
</body>
</html>